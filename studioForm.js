(()=>{let t=typeof gsap,e=typeof Hammer,i='[bmg-form = "Form Block"]',o='[bmg-form = "Visual Divider"]',a='[bmg-form = "Continue Button"]',n='[bmg-form = "Backwards Button"]',r='[bmg-form = "Quiz Result"]',s=".w-radio",d=".w-form-done",u="bmg-data-form-block-index",l="bmg-data-step-index",c="bmg-data-step-type",m="bmg-data-conditional",f="bmg-data-click-element",p="bmg-data-click-element-id",h="bmg-data-autofocus",g="bmg-data-redirect-url",b=[{names:["false"],value:0},{names:["half","50%"],value:.5},{names:["on","true","100%"],value:1},{names:["extreme","200%"],value:2}],v="bmg-data-css-active",w="bmg-data-slide-direction",S="bmg-data-swipe-type-animation",_={opacity:1,display:"flex"},y={opacity:0,display:"none"},x={opacity:1,duration:.1},T={opacity:.5,duration:.1},k={opacity:1},I={opacity:.5},A={..._},E={...y},M={..._},C={...y},L=[];function R(){$(i).each(function(t){"false"!=$(this).attr("bmg-data-auto-delete-conditionally-invisible-elements")&&$(this).find(".w-condition-invisible").remove();let e=$(this),s=X(e,'[bmg-form = "Form"]',0),d=X(s,'[bmg-form = "Form Step"]',"false",`${o}, ${r}`),c=s.find(n),m=s.find('[bmg-form = "Submit Button"]'),g=e.children().not(s),b=g.find(n),v=g.find(a),w=Y(b),_=Y(v),y=e.find('[bmg-form = "Progress Bar"]'),x=Y(y),T=[{step:0}],k=!0,I=J(e);function A(e){if(!(v.length<1))s.find(`[${l} = "${e}"]`).find(`[${f} = "true"]`).length>0?gsap.to(_,L[t].cssBackForthActive):gsap.to(_,L[t].cssBackForthInactive)}Z(e),I<2?(s.find(o).remove(),d.hide(),d.eq(0).show()):console.log(`Dev mode ${I}: Visual dividers not removed...`),gsap.set([w,_],{...L[t].cssBackForthInactive,duration:0}),e.attr(u,t),d.each(function(t){let i=$(this),o=!1,a=V(i,t,e);j(a),a.each(function(t){let e=$(this);e.attr(p,t),e.click(()=>{o||(setTimeout(()=>{o=!1},10),j(a,e),z()),o=!0})})}),c.add(b).each(function(){$(this).click(()=>{O()})}),v.each(function(){$(this).click(()=>{z()})}),m.each(function(){$(this).click(()=>{K()})});let E=P(d),M=L[t].progressBarAnimationSTime,C=L[t].progressBarAxis.toLowerCase();function R(t=!1){if(y.length<1)return;let e=t?100:tt("longest",T,E);["x","x, y","y, x"].includes(C)&&gsap.to(x,{width:e+"%",duration:M}),["y","x, y","y, x"].includes(C)&&gsap.to(x,{height:e+"%",duration:M})}function z(i=!1){let o=T[T.length-1].step,a=E[o];if(i&&"false"==a.swipeAllowed.toLowerCase())return;let n=a.$,r=n.find(`[${f} = "true"]`),d=r.attr(p);1==r.length?B(e,n)?function e(i,o){let a=E[i].buttons[o].nextStepId;if(gsap.to(w,L[t].cssBackForthActive),E[i].isLast)K();else{let n=E[i].$;$nextStep=E[a].$,T.push({step:a}),F(n,$nextStep,s,I),A(a),R()}I>.5&&console.log(`Dev mode ${I}; Click record: `,T)}(o,d):A(o):(H(0,n,e),A(o))}function O(e=!1){let i=T[T.length-1].step,o=T[Math.max(T.length-2,0)].step;if(!e||"false"!=E[i].swipeAllowed.toLowerCase()){if(i!=o){let a=s.find(`[${l} = "${i}"]`),n=s.find(`[${l} = "${o}"]`);T.pop(),F(a,n,s,I)}T.length<=2&&b.length>0&&gsap.to(w,L[t].cssBackForthInactive),A(o),R(),I>.5&&console.log(`Dev mode ${I}; Click record: `,T)}}function K(){if(!B(e,E[T[T.length-1].step].$))return!1;k=!1,W(E,T,e),D(e,T),R(!0),gsap.to([w,_],L[t].cssHide),N(e,s,I)}R(),0==t&&e.attr(h,!0),e.mouseenter(()=>{$(i).attr(h,!1),e.attr(h,!0)});let G=(e.attr("bmg-data-esc-event")||"escape, esc, arrowup, up").split(", "),Q=(e.attr("bmg-data-enter-event")||"enter, arrowdown, down").split(", "),U=(e.attr("bmg-data-left-event")||"arrowleft, left").split(", "),te=(e.attr("bmg-data-right-event")||"arrowright, right").split(", ");document.onkeydown=function(t){t=t||window.event;let i=T[T.length-1].step;if("false"!=s.find(`[${l} = "${i}"]`).attr("bmg-data-keyboard-events")&&"key"in t&&k&&"true"==e.attr(h)){let o=t.key.toLowerCase();G.includes(o)?O():Q.includes(o)&&!t.shiftKey?z():U.includes(o)&&!t.shiftKey?to(-1):te.includes(o)&&!t.shiftKey&&to(1)}};let ti="true"==L[t].leftRightKeyEventInfinityAllowed;function to(t=1){let i=E[T[T.length-1].step].$,o=i.find(`[${p}]`).length-1,a=parseInt(i.find(`[${f} = "true"]`).attr(p)||-2),n=-2==a?0:a+t;H(n=ti?(n=n>o?0:n)<0?o:n:(n=n>o?o:n)<0?0:n,i,e)}q(e);let ta=Hammer(e[0]),tn=e.attr(S);"false"==tn||("to bottom"==tn?(ta.get("swipe").set({direction:Hammer.DIRECTION_ALL}),ta.on("swipeup",()=>{O(!0)}),ta.on("swipedown",()=>{z(!0)})):"to top"==tn||"vertical"==tn?(ta.get("swipe").set({direction:Hammer.DIRECTION_ALL}),ta.on("swipeup",()=>{z(!0)}),ta.on("swipedown",()=>{O(!0)})):"to left"==tn||"default"==tn||"horizontal"==tn?(ta.on("swipeleft",()=>{z(!0)}),ta.on("swiperight",()=>{O(!0)})):"to right"==tn?(ta.on("swipeleft",()=>{O(!0)}),ta.on("swiperight",()=>{z(!0)})):"4"==tn||"270\xb0"==tn?(ta.get("swipe").set({direction:Hammer.DIRECTION_ALL}),ta.on("swipeup",()=>{O(!0)}),ta.on("swipeleft",()=>{z(!0)}),ta.on("swiperight",()=>{z(!0)}),ta.on("swipedown",()=>{O(!0)})):"3"==tn||"180\xb0"==tn?(ta.get("swipe").set({direction:Hammer.DIRECTION_ALL}),ta.on("swipeup",()=>{O(!0)}),ta.on("swipeleft",()=>{z(!0)}),ta.on("swiperight",()=>{z(!0)}),ta.on("swipedown",()=>{O(!0)})):"2"==tn||"90\xb0"==tn?(ta.get("swipe").set({direction:Hammer.DIRECTION_ALL}),ta.on("swipeup",()=>{O(!0)}),ta.on("swipeleft",()=>{z(!0)}),ta.on("swiperight",()=>{z(!0)}),ta.on("swipedown",()=>{O(!0)})):(ta.get("swipe").set({direction:Hammer.DIRECTION_ALL}),ta.on("swipeup",()=>{z(!0)}),ta.on("swipeleft",()=>{z(!0)}),ta.on("swiperight",()=>{O(!0)}),ta.on("swipedown",()=>{O(!0)})))})}function z(t="add",e,i){let o=L[i],a=o.cssErrorStatus,n=o.cssErrorStatusResolved,r=Y(e);"add"==t?gsap.to(r,a):gsap.to(r,n)}function B(t,e){let i=e.attr(c),o="true"==(e.attr("bmg-data-required")||"true");if(styleIndex=parseInt(t.attr(u)),!o||"empty"==i)return!0;if("checkbox"==i)return console.log(`Please continue to programm the required checking functionality for ${i} step types.`),!0;if("radio"==i){let a=e.find(s),n=a.find(".w--redirected-checked");return!!e.find(`[${p}]`).hasClass(s.substring(1))||0!=n.length||(z("add",a,styleIndex),a.off("click.stepRequirements"),a.on("click.stepRequirements",function(){z("remove",a,styleIndex),a.off("click.stepRequirements")}),!1)}{let r=!0,d=e.find("input, select");return z("remove",d,styleIndex),d.each(function(){let t=$(this);t.prop("required")&&""==t.val()&&(r=!1,z("add",t,styleIndex))}),!!r&&(z("remove",d,styleIndex),!0)}}function H(t,e,i){let o=L[parseInt(i.attr(u))],a=o.cssDeselect,n=o.cssSelect,r=e.find(`[${p}]`),s=Y(r),d=e.find(`[${p} = ${t}]`);j(r,d),gsap.to(s,a),gsap.to(d[0],n)}function D(t,e){let i=t[0].querySelector(d).querySelectorAll(r),o=L[parseInt(t.attr(u))].redirectMsTime;if(i.length>0){console.log(i);let a=i[0],n=a.getAttribute(g);if(void 0!=n){setTimeout(()=>{n=a.getAttribute(g),location.assign(n)},o);return}console.log("Todo: Set up quiz mode funcitonality. Url functionality, nested forms, etc.")}}function q(t){let e=parseInt(t.attr(u)),i=t.attr(S),o=L[e],a=o.slideDirection.toLowerCase(),n=o.maxSwipeScreenSize,r=o.minSwipeScreenSize,s=$(window).outerWidth(!0);s<=n&&s>=r?(void 0!=i&&(a=i),t.attr(S,a)):t.attr(S,"false")}function N(t,e,i=0,o=[]){let a=t.find(d),n=L[t.attr(u)],r=n.submitMsTime1/1e3,s=n.submitMsTime2/1e3,l=n.submitHide,c={...l,duration:0};submitShow=n.submitShow,resizeHeight1=e.outerHeight(!0),resizeHeight2=a.outerHeight(!0),multiplier1=n.autoResizeSuccessTimeMultiplier1,multiplier2=n.autoResizeSuccessTimeMultiplier2,submitTimeout=(l.duration+submitShow.duration)*1e3,tl=new gsap.timeline,resizeTl=new gsap.timeline,i<.5?setTimeout(()=>{e.submit()},submitTimeout):console.log(`Dev mode ${i}: Perform fake submit...`),tl.set(a[0],c),tl.to(e[0],l),tl.to(a[0],submitShow),resizeHeight2>=resizeHeight1?resizeTl.to(t[0],{height:resizeHeight2,duration:r*multiplier1}):(resizeTl.set(t[0],{height:resizeHeight1}),resizeTl.to(t[0],{height:resizeHeight2,duration:s*multiplier2}).delay(r)),resizeTl.set(t[0],{height:"auto"})}let O=!1;function F(t,e,o,a=0){if(a>=2){console.log(`Dev mode ${a}: Block the transition animation...`);return}let n=o.find(`[${l}]`).not(t).not(e),r=L[parseInt(o.closest(i).attr(u))],s=r.cssShow,d=r.cssHide,c={...d,duration:0},m=new gsap.timeline,f=t.outerHeight(!0),p=e.outerHeight(!0);if(speedMultiplierString=`<+=${100*(f==p?r.equalHeightTransitionSpeedMultiplier:1)}%`,isReverse=parseInt(t.attr(l))>parseInt(e.attr(l)),slideDirection=(t.attr(w)||r.slideDirection).toLowerCase(),autoResizeTime1=s.duration,autoResizeTime2=d.duration,autoResizeTimeMultiplier1=r.autoResizeTimeMultiplier1,autoResizeTimeMultiplier2=r.autoResizeTimeMultiplier2,isReverse&&(slideDirection=(e.attr(w)||slideDirection).toLowerCase()),a>=2&&console.log(`Dev mode ${a}; GSAP transition speed multiplier string: ${speedMultiplierString}`),"to bottom"==slideDirection){let h={...s,y:0},g={...d,y:-o.outerHeight(!0)},b={...g,duration:0},v={...s,y:0},S={...d,y:o.outerHeight(!0)},_={...S,duration:0};isReverse?(m.to(t[0],g),m.fromTo(e[0],_,v,speedMultiplierString)):(m.to(t[0],S),m.fromTo(e[0],b,h,speedMultiplierString))}else if("to top"==slideDirection){let y={...s,y:0},x={...d,y:-o.outerHeight(!0)},T={...x,duration:0},k={...s,y:0},I={...d,y:o.outerHeight(!0)},A={...I,duration:0};isReverse?(m.to(t[0],I),m.fromTo(e[0],T,y,speedMultiplierString)):(m.to(t[0],x),m.fromTo(e[0],A,k,speedMultiplierString))}else if("to left"==slideDirection||"default"==slideDirection){let E={...s,x:0},M={...d,x:-o.outerWidth(!0)},C={...M,duration:0},R={...s,x:0},z={...d,x:o.outerWidth(!0)},B={...z,duration:0};isReverse?(m.to(t[0],z),m.fromTo(e[0],C,E,speedMultiplierString)):(m.to(t[0],M),m.fromTo(e[0],B,R,speedMultiplierString))}else if("to right"==slideDirection){let H={...s,x:0},D={...d,x:-o.outerWidth(!0)},q={...D,duration:0},N={...s,x:0},F={...d,x:o.outerWidth(!0)},P={...F,duration:0};isReverse?(m.to(t[0],D),m.fromTo(e[0],P,N,speedMultiplierString)):(m.to(t[0],F),m.fromTo(e[0],q,H,speedMultiplierString))}else if("none"==slideDirection)m.to(t[0],d),m.fromTo(e[0],c,s);else{let j=r.customNextSlideIn,W=r.customNextSlideOut,K=r.customPrevSlideIn,V=r.customPrevSlideOut,X=r.customXMultiplier,Y=r.customYMultiplier;void 0==j.x&&(j.x=0),void 0==W.x&&(W.x=X*o.outerWidth(!0)),void 0==K.x&&(K.x=0),void 0==V.x&&(V.x=-X*o.outerWidth(!0)),void 0==j.y&&(j.y=0),void 0==W.y&&(W.y=Y*o.outerHeight(!0)),void 0==K.y&&(K.y=0),void 0==V.y&&(V.y=-Y*o.outerHeight(!0));let G={...V,duration:0},Q={...W,duration:0};isReverse?(autoResizeTime1=K.duration,autoResizeTime2=V.duration,m.to(t[0],V),m.fromTo(e[0],Q,K,speedMultiplierString)):(autoResizeTime1=j.duration,autoResizeTime2=W.duration,m.to(t[0],W),m.fromTo(e[0],G,j,speedMultiplierString))}p>=f?gsap.to(o[0],{height:p,duration:autoResizeTime1*autoResizeTimeMultiplier1}):(gsap.set(o[0],{height:f}),gsap.to(o[0],{height:p,duration:autoResizeTime2*autoResizeTimeMultiplier2}).delay(autoResizeTime1)),O&&O.clear(),O=m,n.hide()}function P(t){let e=[];t.each(function(t){let i=$(this),o=i.find(`[${p}]`),a=[];o.each(function(){let t=$(this);a.push({id:t.attr(p),conditional:t.attr(m)})}),e.push({$:i,step:t,swipeAllowed:i.attr("bmg-data-swipe-allowed")||"true",conditional:i.attr(m),conditionalNext:i.attr("bmg-data-conditional-next"),buttons:a})});let i=e.length;return e.forEach(t=>{let o=t.step,a=t.$.attr("bmg-data-relative-last-step");t.isLast=o==i-1,"true"==a&&(t.isLast=!0),t.buttons.forEach(i=>{void 0!=i.conditional?i.nextStepId=(()=>{for(t of e)if(t.conditional==i.conditional)return t.step})():void 0!=t.conditionalNext?i.nextStepId=o+1:i.nextStepId=(()=>{for(t of e)if(t.step>o&&void 0==t.conditional)return t.step})()})}),e}function j(t,e=!1){t.attr(f,!1),e&&e.attr(f,!0)}function W(t,e,i){"true"==(i.attr("bmg-data-remove-other-steps")||"true")&&t.forEach(t=>{let i=!1,o=t.step;e.forEach(t=>{o==t.step&&(i=!0)}),t.isLast&&(i=!0),i||t.$.remove()})}function K(t,e,i){let o=L[e],a=o.cssActive,n=o.cssInactive,r=o.setCssInactive,s="radio"==i.attr(c),d=Y(t);gsap.set(d,r),s?t.each(function(){let t=$(this);t.click(()=>{gsap.to(d,n),gsap.to(t[0],a)})}):t.each(function(){let t=$(this),e=!0,i=!1;if("none"==t.attr(v))return!0;t.click(()=>{i||(setTimeout(()=>{i=!1},10),e?(t.css(a),e=!1):(t.css(n),e=!0)),i=!0})})}function V(t,e,i){let o=t.find(s),r=t.find(".w-checkbox"),d=t.find(`a, ${a}, .w-button`).not('[bmg-form = "Not a Button"]').not(n),m=t.find("input"),f=parseInt(i.attr(u));return(t.attr(l,e),o.length>0)?(void 0==t.attr(c)&&t.attr(c,"radio"),K(o,f,t),o.find("input").removeAttr("required"),void 0!=t.attr("bmg-data-not-auto-continue")?d:o):r.length>0?(void 0==t.attr(c)&&t.attr(c,"checkbox"),K(r,f,t),d):m.length>0?(void 0==t.attr(c)&&t.attr(c,"other input"),K(r,f,t),d):(t.attr(c,"empty"),d)}function X(t,e,i="false",o="false"){let a=t.find(e),n=t.children();return a.length>0?a:("false"!=o&&(n=n.not(o)),"false"!=i&&(n=n.eq(i)),n)}function Y(t){let e=[];return t.each(function(){e.push(this)}),e}function G(t,e,i,o=!0){return"{}"==(t.attr(e)||"{}")?{...i}:JSON.parse(Q(t.attr(e),!0))}function Q(t,e=!0){let i=U(t.replace(", ",",")).split(","),o="",a=i.length-1;return(i.forEach((t,e)=>{t.replace(/\'/g,"").replace(": ",":").split(":").forEach((t,e)=>{o+=`"${t}"${e>0?"":": "}`}),o+=e<a?", ":""}),e)?`{${o}}`:o}function U(t){return t.substring(1).slice(0,-1)}function J(t){let e=t.attr("bmg-data-dev-mode"),i=0;return b.forEach(t=>{t.names.forEach(o=>{o==e&&(i=t.value)})}),i}function Z(t){L.push({animationMsTime:parseFloat(t.attr("bmg-data-animation-ms-time")||500),equalHeightTransitionSpeedMultiplier:parseFloat(t.attr("bmg-data-equal-height-transition-speed-multiplier")||.25),cssShow:G(t,"bmg-data-css-show",_),cssHide:G(t,"bmg-data-css-hide",y),cssActive:G(t,v,x),cssInactive:G(t,"bmg-data-css-inactive",T),cssBackForthActive:G(t,"bmg-data-back-forth-css-active",k),cssBackForthInactive:G(t,"bmg-data-back-forth-css-inactive",I),errorColor:t.attr("bmg-data-error-color")||"red",slideDirection:t.attr(w)||"to left",customNextSlideIn:G(t,"bmg-data-custom-next-slide-in",A),customNextSlideOut:G(t,"bmg-data-custom-next-slide-out",E),customPrevSlideIn:G(t,"bmg-data-custom-prev-slide-in",M),customPrevSlideOut:G(t,"bmg-data-custom-prev-slide-out",C),customXMultiplier:parseFloat(t.attr("bmg-data-custom-x-percentage-multiplier")||0),customYMultiplier:parseFloat(t.attr("bmg-data-custom-y-percentage-multiplier")||0),autoResizeTimeMultiplier1:parseFloat(t.attr("bmg-data-auto-resize-time-multiplier-1")||1),autoResizeTimeMultiplier2:parseFloat(t.attr("bmg-data-auto-resize-time-multiplier-2")||.5),autoResizeSuccessTimeMultiplier1:parseFloat(t.attr("bmg-data-auto-resize-time-multiplier-1")||1),autoResizeSuccessTimeMultiplier2:parseFloat(t.attr("bmg-data-auto-resize-time-multiplier-2")||.85),maxSwipeScreenSize:parseInt(t.attr("bmg-data-max-swipe-screen-size")||767),minSwipeScreenSize:parseInt(t.attr("bmg-data-min-swipe-screen-size")||0),leftRightKeyEventInfinityAllowed:t.attr("bmg-data-left-key-event-infintiy-allowed")||"true",redirectMsTime:parseFloat(t.attr("bmg-data-redirect-ms-time")||1)});let e=L[L.length-1],i=e.cssShow,o=e.cssHide,a=e.cssBackForthActive,n=e.cssBackForthInactive,r=e.cssActive,s=e.cssInactive,d=e.customNextSlideIn,u=e.customNextSlideOut,l=e.customPrevSlideIn,c=e.customPrevSlideOut;e.animationSTime=e.animationMsTime/1e3,void 0==i.duration&&(i.duration=e.animationSTime),void 0==o.duration&&(o.duration=e.animationSTime),void 0==a.duration&&(a.duration=e.animationSTime),void 0==n.duration&&(n.duration=e.animationSTime),void 0==r.duration&&(r.duration=e.animationSTime),void 0==s.duration&&(s.duration=e.animationSTime),void 0==d.duration&&(d.duration=e.animationSTime),void 0==u.duration&&(u.duration=e.animationSTime),void 0==l.duration&&(l.duration=e.animationSTime),void 0==c.duration&&(c.duration=e.animationSTime),e.submitMsTime1=parseFloat(t.attr("bmg-data-submit-ms-time-1"))||e.animationMsTime,e.submitMsTime2=parseFloat(t.attr("bmg-data-submit-ms-time-2"))||e.animationMsTime,e.submitHide=G(t,"bmg-data-submit-hide",o),e.submitShow=G(t,"bmg-data-submit-show",{...i,duration:1.5*e.animationSTime}),void 0==e.submitHide.duration&&(e.submitHide.duration=e.submitMsTime1/1e3),void 0==e.submitShow.duration&&(e.submitShow.duration=e.submitMsTime2/1e3),e.setCssInactive=G(t,"bmg-data-set-css-inactive",s),delete e.setCssInactive.duration,e.cssSelect=G(t,"bmg-data-css-select",r),e.cssDeselect=G(t,"bmg-data-css-deselect",s),e.cssErrorStatus=G(t,"bmg-data-css-error-status",{duration:e.animationSTime}),e.cssErrorStatusResolved=G(t,"bmg-data-css-error-status-resolved",{duration:e.animationSTime}),void 0==e.cssErrorStatus.borderColor&&(e.cssErrorStatus.borderColor=e.errorColor),void 0==e.cssErrorStatusResolved.borderColor&&(e.cssErrorStatusResolved.borderColor=""),e.progressBarAnimationSTime=parseFloat(t.attr("bmg-data-progress-bar-ms-time")||e.animationMsTime)/1e3,e.progressBarAxis=t.attr("bmg-data-progress-bar-axis")||"x"}function tt(t,e,i){let o=e[e.length-1].step,a=e.length,n=i.length,r=0,s=0,d=0,u=[];return(!function t(e){var o;let a,l=(o=e,a=[],o.buttons.forEach(t=>{-1===a.indexOf(t.nextStepId)&&a.push(t.nextStepId)}),a);if(s++,d++,l.length>1&&(u.push(d),d=0),e.isLast){r=Math.max(r,s),n=Math.min(n,s),s=0,u.forEach(t=>{s+=t}),u.pop();return}l.forEach((e,o)=>{t(i[e])})}(i[o]),n+=a,r+=a,"shortest"==t)?100*(a/n):100*(a/r)}function te(){"undefined"==t?$.loadScript("https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/gsap.min.js",function(){R()}):R()}jQuery.loadScript=function(t,e){jQuery.ajax({url:t,dataType:"script",success:e,async:!0})},"undefined"==e?$.loadScript("https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js",function(){te()}):te()})();
